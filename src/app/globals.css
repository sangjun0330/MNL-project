@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light;
  --wnl-bg: #F7F7F8;
  --wnl-text: #1C1C1E;
  --wnl-sub: rgba(28, 28, 30, 0.72);
  --wnl-muted: rgba(28, 28, 30, 0.56);
  --wnl-card: #FFFFFF;
  --wnl-sep: rgba(60, 60, 67, 0.18);
  --wnl-accent: #007AFF;
  --wnl-selection: rgba(0, 122, 255, 0.16);
  --wnl-ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
  --wnl-ease-soft: cubic-bezier(0.22, 1, 0.36, 1);
  --wnl-dur-fast: 180ms;
  --wnl-dur-med: 320ms;
  --wnl-dur-slow: 420ms;
  --wnl-dur-page: 520ms;
  --wnl-dur-sheet: 520ms;
  --wnl-dur-modal: 420ms;
  --wnl-ease-apple: cubic-bezier(0.22, 1, 0.36, 1);

  /* Liquid Glass 기본 튜닝값 */
  --lg-radius: 24px;
  --lg-tint: rgba(255, 255, 255, 0.08);
  --lg-border: rgba(255, 255, 255, 0.18);
  --lg-blur: 16px;
  --lg-saturate: 1.15;
  --lg-brightness: 1.15;
  --lg-highlight: rgba(255, 255, 255, 0.55);
  --lg-noise-opacity: 0.06;
  --lg-shadow:
    0 4px 8px rgba(0, 0, 0, 0.25),
    0 -10px 25px inset rgba(0, 0, 0, 0.15),
    0 -1px 4px 1px inset rgba(255, 255, 255, 0.74);
}

html, body {
  height: 100%;
}

body {
  background-color: var(--wnl-bg);
  color: var(--wnl-text);
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display",
    "Apple SD Gothic Neo", "Noto Sans KR", "Helvetica Neue", "Segoe UI", Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
  letter-spacing: -0.01em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  transition: background-color var(--wnl-dur-page) var(--wnl-ease-smooth),
    color var(--wnl-dur-page) var(--wnl-ease-smooth);
}

/* ✅ iOS-like tap behaviour */
* { -webkit-tap-highlight-color: transparent; }

/* ✅ Page transition (bottom tab 이동 시) */
@keyframes wnlPageEnter {
  from { opacity: 0; transform: translate3d(0, 10px, 0) scale(0.985); filter: blur(3px); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); filter: blur(0); }
}

.wnl-page-enter {
  animation: wnlPageEnter var(--wnl-dur-page) var(--wnl-ease-apple);
  will-change: transform, opacity, filter;
}

@keyframes wnlBackdropIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes wnlModalIn {
  from { opacity: 0; transform: translate3d(0, 12px, 0) scale(0.985); filter: blur(4px); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); filter: blur(0); }
}

.wnl-backdrop {
  animation: wnlBackdropIn var(--wnl-dur-modal) var(--wnl-ease-apple);
}

.wnl-modal {
  animation: wnlModalIn var(--wnl-dur-modal) var(--wnl-ease-apple);
  will-change: transform, opacity, filter;
}

/* ========= Liquid Glass (Apple-ish) Drop-in ========= */
.liquid-glass {
  position: relative;
  overflow: hidden;
  border-radius: var(--lg-radius);
  background: var(--lg-tint);
  border: 1px solid var(--lg-border);
  box-shadow: var(--lg-shadow);
  -webkit-backdrop-filter: blur(var(--lg-blur)) saturate(var(--lg-saturate))
    brightness(var(--lg-brightness));
  backdrop-filter: blur(var(--lg-blur)) saturate(var(--lg-saturate))
    brightness(var(--lg-brightness));
  transform: translateZ(0);
  backface-visibility: hidden;
}

.liquid-glass::before {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  background: radial-gradient(
      120% 80% at 20% 0%,
      var(--lg-highlight),
      transparent 55%
    ),
    linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.16),
      transparent 35%
    );
  mix-blend-mode: screen;
  opacity: 0.9;
}

.liquid-glass::after {
  content: "";
  position: absolute;
  inset: -20%;
  pointer-events: none;
  border-radius: inherit;
  background-image:
    repeating-linear-gradient(
      0deg,
      rgba(255, 255, 255, 0.035) 0px,
      rgba(255, 255, 255, 0.035) 1px,
      transparent 2px,
      transparent 4px
    );
  opacity: var(--lg-noise-opacity);
  transform: rotate(8deg);
}

.liquid-glass:hover {
  -webkit-backdrop-filter: blur(calc(var(--lg-blur) + 2px)) saturate(calc(var(--lg-saturate) + 0.05))
    brightness(calc(var(--lg-brightness) + 0.05));
  backdrop-filter: blur(calc(var(--lg-blur) + 2px)) saturate(calc(var(--lg-saturate) + 0.05))
    brightness(calc(var(--lg-brightness) + 0.05));
}

.liquid-glass--pill { --lg-radius: 999px; }
.liquid-glass--strong {
  --lg-tint: rgba(255, 255, 255, 0.12);
  --lg-border: rgba(255, 255, 255, 0.24);
  --lg-blur: 20px;
}
.liquid-glass--subtle {
  --lg-tint: rgba(255, 255, 255, 0.06);
  --lg-border: rgba(255, 255, 255, 0.14);
  --lg-blur: 12px;
}

/* BottomNav glass shell (Apple-ish) */
.wnl-bottom-nav {
  --lg-radius: 999px;
  --lg-tint: rgba(255, 255, 255, 0.22);
  --lg-border: rgba(255, 255, 255, 0.4);
  --lg-blur: 24px;
  --lg-saturate: 1.35;
  --lg-brightness: 1.08;
  --lg-highlight: rgba(255, 255, 255, 0.7);
  --lg-noise-opacity: 0.035;
  --lg-shadow:
    0 18px 36px rgba(0, 0, 0, 0.18),
    0 1px 0 rgba(255, 255, 255, 0.55) inset,
    0 -12px 26px inset rgba(0, 0, 0, 0.12);
}

.wnl-nav-item {
  transition:
    transform 260ms var(--wnl-ease-apple),
    color 260ms var(--wnl-ease-apple),
    background-color 260ms var(--wnl-ease-apple);
  transform: translateZ(0);
}

/* BottomNav active pill glass tuning */
.wnl-nav-active {
  --lg-tint: rgba(255, 255, 255, 0.45);
  --lg-border: rgba(255, 255, 255, 0.65);
  --lg-blur: 26px;
  --lg-saturate: 1.45;
  --lg-brightness: 1.2;
  --lg-highlight: rgba(255, 255, 255, 0.9);
  --lg-noise-opacity: 0.02;
  --lg-shadow:
    0 12px 22px rgba(0, 0, 0, 0.18),
    0 1px 0 rgba(255, 255, 255, 0.75) inset,
    0 -8px 16px inset rgba(0, 0, 0, 0.1);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.78), rgba(255, 255, 255, 0.35)),
    var(--lg-tint);
  color: #0F0F10;
}

@supports not ((backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px))) {
  .liquid-glass {
    background: rgba(255, 255, 255, 0.12);
  }
}

@keyframes wnlPageEnterMobile {
  from { opacity: 0; transform: translate3d(0, 8px, 0) scale(0.99); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
}

@keyframes wnlModalInMobile {
  from { opacity: 0; transform: translate3d(0, 10px, 0) scale(0.99); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
}

@media (hover: none) and (pointer: coarse) {
  .wnl-page-enter { animation: wnlPageEnterMobile var(--wnl-dur-page) var(--wnl-ease-apple); }
  .wnl-modal { animation: wnlModalInMobile var(--wnl-dur-modal) var(--wnl-ease-apple); }
  .wnl-backdrop {
    -webkit-backdrop-filter: blur(3px) saturate(1);
    backdrop-filter: blur(3px) saturate(1);
  }
  .liquid-glass { --lg-blur: 16px; --lg-saturate: 1.2; }
  .wnl-bottom-nav { --lg-blur: 20px; }
  .wnl-nav-active { --lg-blur: 22px; }
}

@media (prefers-reduced-motion: reduce) {
  .wnl-page-enter { animation: none; }
  .wnl-backdrop,
  .wnl-modal { animation: none; }
  .wnl-breathe,
  .wnl-wave,
  .wnl-pulse-soft,
  .wnl-float-up { animation: none; }
  body { transition: none; }
}

::selection {
  background: var(--wnl-selection);
}

/* iOS safe-area helper */
.safe-top { padding-top: env(safe-area-inset-top); }
.safe-bottom { padding-bottom: env(safe-area-inset-bottom); }

/* Subtle scrollbars for desktop */
*::-webkit-scrollbar { height: 8px; width: 8px; }
*::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.14); border-radius: 999px; }
*::-webkit-scrollbar-track { background: transparent; }

/* =========================
   WNL Insight v2.0 motion
   ========================= */

@keyframes wnlBreathe {
  0%, 100% { transform: scale(0.99); opacity: 0.6; }
  50% { transform: scale(1.01); opacity: 0.95; }
}

@keyframes wnlWave {
  0% { transform: translateX(0); }
  100% { transform: translateX(-160px); }
}

@keyframes wnlPulseSoft {
  0%, 100% { opacity: 0.75; }
  50% { opacity: 1; }
}

@keyframes wnlFloatUp {
  0% { opacity: 0; transform: translateY(8px); }
  20% { opacity: 1; }
  100% { opacity: 0; transform: translateY(-16px); }
}

.wnl-breathe {
  animation: wnlBreathe 3.6s ease-in-out infinite;
}

.wnl-wave {
  animation: wnlWave 4.4s linear infinite;
}

.wnl-pulse-soft {
  animation: wnlPulseSoft 1.6s ease-in-out infinite;
}

.wnl-float-up {
  animation: wnlFloatUp 1.2s ease-out forwards;
}

/* =========================
   WNL Night Mode (auto)
   Trigger: night_streak >= 3
   ========================= */

html.wnl-night {
  color-scheme: dark;
  --wnl-bg: #0B1220;
  --wnl-text: rgba(255,255,255,0.92);
  --wnl-sub: rgba(255,255,255,0.64);
  --wnl-muted: rgba(255,255,255,0.52);
  --wnl-card: #111A2E;
  --wnl-sep: rgba(255,255,255,0.12);
  --wnl-accent: #6CDAC3;
  --wnl-selection: rgba(108,218,195,0.22);
}

html.wnl-night body {
  background-color: var(--wnl-bg);
  color: var(--wnl-text);
}

html.wnl-night *::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.18);
}

/* Tailwind token overrides (best-effort) */
html.wnl-night .bg-ios-bg { background-color: #0B1220 !important; }
html.wnl-night .bg-ios-card { background-color: #111A2E !important; }
html.wnl-night .border-ios-sep { border-color: rgba(255,255,255,0.12) !important; }
html.wnl-night .text-ios-text { color: rgba(255,255,255,0.92) !important; }
html.wnl-night .text-ios-sub { color: rgba(255,255,255,0.62) !important; }
html.wnl-night .text-ios-muted { color: rgba(255,255,255,0.55) !important; }

/* Common utility colors used across the app */
html.wnl-night .bg-white { background-color: #111A2E !important; }
html.wnl-night .bg-white\/90 { background-color: rgba(17,26,46,0.90) !important; }
html.wnl-night .bg-white\/85 { background-color: rgba(17,26,46,0.85) !important; }
html.wnl-night .bg-white\/80 { background-color: rgba(17,26,46,0.80) !important; }
html.wnl-night .bg-white\/70 { background-color: rgba(17,26,46,0.70) !important; }
html.wnl-night .bg-white\/60 { background-color: rgba(17,26,46,0.60) !important; }
html.wnl-night .bg-white\/50 { background-color: rgba(17,26,46,0.50) !important; }

html.wnl-night .text-black { color: rgba(255,255,255,0.92) !important; }
html.wnl-night .text-black\/80 { color: rgba(255,255,255,0.80) !important; }
html.wnl-night .text-black\/70 { color: rgba(255,255,255,0.70) !important; }
html.wnl-night .text-black\/60 { color: rgba(255,255,255,0.60) !important; }
html.wnl-night .text-black\/50 { color: rgba(255,255,255,0.50) !important; }

html.wnl-night .bg-black\/5 { background-color: rgba(255,255,255,0.08) !important; }
html.wnl-night .bg-black\/7 { background-color: rgba(255,255,255,0.10) !important; }
html.wnl-night .bg-black\/10 { background-color: rgba(255,255,255,0.12) !important; }

html.wnl-night .focus\:ring-black\/10:focus { --tw-ring-color: rgba(255,255,255,0.18) !important; }

/* BottomNav active tab (Design Spec request): Black -> Mint in night mode */
html.wnl-night .wnl-bottom-nav {
  --lg-tint: rgba(18, 20, 28, 0.55);
  --lg-border: rgba(255, 255, 255, 0.12);
  --lg-blur: 22px;
  --lg-saturate: 1.05;
  --lg-brightness: 0.95;
  --lg-highlight: rgba(255, 255, 255, 0.2);
  --lg-noise-opacity: 0.02;
  --lg-shadow:
    0 18px 36px rgba(0, 0, 0, 0.5),
    0 1px 0 rgba(255, 255, 255, 0.08) inset,
    0 -12px 22px inset rgba(0, 0, 0, 0.35);
}

html.wnl-night .wnl-nav-active {
  --lg-tint: rgba(108, 218, 195, 0.32);
  --lg-border: rgba(108, 218, 195, 0.6);
  --lg-blur: 24px;
  --lg-saturate: 1.15;
  --lg-brightness: 1.05;
  --lg-highlight: rgba(214, 255, 245, 0.75);
  --lg-noise-opacity: 0.02;
  --lg-shadow:
    0 12px 22px rgba(0, 0, 0, 0.45),
    0 1px 0 rgba(255, 255, 255, 0.3) inset,
    0 -8px 16px inset rgba(0, 0, 0, 0.25);
  background: linear-gradient(180deg, rgba(200, 255, 242, 0.4), rgba(108, 218, 195, 0.22)),
    var(--lg-tint);
  color: #0B1220 !important;
}
