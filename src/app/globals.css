@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light;
  --wnl-bg: #F7F7F8;
  --wnl-text: #1C1C1E;
  --wnl-sub: rgba(28, 28, 30, 0.72);
  --wnl-muted: rgba(28, 28, 30, 0.56);
  --wnl-card: #FFFFFF;
  --wnl-sep: rgba(60, 60, 67, 0.18);
  --wnl-accent: #007AFF;
  --wnl-selection: rgba(0, 122, 255, 0.16);
  --wnl-ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
  --wnl-ease-soft: cubic-bezier(0.22, 1, 0.36, 1);
  --wnl-dur-fast: 180ms;
  --wnl-dur-med: 320ms;
  --wnl-dur-slow: 420ms;
  --wnl-dur-page: 520ms;
  --wnl-dur-sheet: 520ms;
  --wnl-dur-modal: 420ms;
  --wnl-ease-apple: cubic-bezier(0.22, 1, 0.36, 1);
}

html, body {
  height: 100%;
}

body {
  background-color: var(--wnl-bg);
  color: var(--wnl-text);
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display",
    "Apple SD Gothic Neo", "Noto Sans KR", "Helvetica Neue", "Segoe UI", Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
  letter-spacing: -0.01em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  transition: background-color var(--wnl-dur-page) var(--wnl-ease-smooth),
    color var(--wnl-dur-page) var(--wnl-ease-smooth);
}

/* ✅ iOS-like tap behaviour */
* { -webkit-tap-highlight-color: transparent; }

/* ✅ Page transition (bottom tab 이동 시) */
@keyframes wnlPageEnter {
  from { opacity: 0; transform: translate3d(0, 10px, 0) scale(0.985); filter: blur(3px); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); filter: blur(0); }
}

.wnl-page-enter {
  animation: wnlPageEnter var(--wnl-dur-page) var(--wnl-ease-apple);
  will-change: transform, opacity, filter;
}

@keyframes wnlBackdropIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes wnlModalIn {
  from { opacity: 0; transform: translate3d(0, 12px, 0) scale(0.985); filter: blur(4px); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); filter: blur(0); }
}

.wnl-backdrop {
  animation: wnlBackdropIn var(--wnl-dur-modal) var(--wnl-ease-apple);
}

.wnl-modal {
  animation: wnlModalIn var(--wnl-dur-modal) var(--wnl-ease-apple);
  will-change: transform, opacity, filter;
}

/* BottomNav (Simple Apple style) */
.wnl-nav-bar {
  border-radius: 999px;
  background: #ffffff;
  border: 1px solid rgba(60, 60, 67, 0.12);
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.08);
}

.wnl-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  min-height: 44px;
  padding: 6px 8px;
  border-radius: 999px;
  transition:
    transform 220ms var(--wnl-ease-apple),
    color 220ms var(--wnl-ease-apple),
    background-color 220ms var(--wnl-ease-apple);
}

.wnl-nav-icon {
  width: 20px;
  height: 20px;
}

.wnl-nav-label {
  font-size: 11px;
  font-weight: 600;
  line-height: 1;
}

.wnl-nav-active {
  background: #F2F2F7;
  color: var(--wnl-accent);
}

.wnl-nav-inactive {
  color: rgba(60, 60, 67, 0.6);
}

@keyframes wnlPageEnterMobile {
  from { opacity: 0; transform: translate3d(0, 8px, 0) scale(0.99); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
}

@keyframes wnlModalInMobile {
  from { opacity: 0; transform: translate3d(0, 10px, 0) scale(0.99); }
  to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
}

@media (hover: none) and (pointer: coarse) {
  .wnl-page-enter { animation: wnlPageEnterMobile var(--wnl-dur-page) var(--wnl-ease-apple); }
  .wnl-modal { animation: wnlModalInMobile var(--wnl-dur-modal) var(--wnl-ease-apple); }
  .wnl-backdrop {
    -webkit-backdrop-filter: blur(3px) saturate(1);
    backdrop-filter: blur(3px) saturate(1);
  }
}

@media (prefers-reduced-motion: reduce) {
  .wnl-page-enter { animation: none; }
  .wnl-backdrop,
  .wnl-modal { animation: none; }
  .wnl-breathe,
  .wnl-wave,
  .wnl-pulse-soft,
  .wnl-float-up { animation: none; }
  body { transition: none; }
}

::selection {
  background: var(--wnl-selection);
}

/* iOS safe-area helper */
.safe-top { padding-top: env(safe-area-inset-top); }
.safe-bottom { padding-bottom: env(safe-area-inset-bottom); }

/* Subtle scrollbars for desktop */
*::-webkit-scrollbar { height: 8px; width: 8px; }
*::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.14); border-radius: 999px; }
*::-webkit-scrollbar-track { background: transparent; }

/* =========================
   RNest Insight v2.0 motion
   ========================= */

@keyframes wnlBreathe {
  0%, 100% { transform: scale(0.99); opacity: 0.6; }
  50% { transform: scale(1.01); opacity: 0.95; }
}

@keyframes wnlWave {
  0% { transform: translateX(0); }
  100% { transform: translateX(-160px); }
}

@keyframes wnlPulseSoft {
  0%, 100% { opacity: 0.75; }
  50% { opacity: 1; }
}

@keyframes wnlFloatUp {
  0% { opacity: 0; transform: translateY(8px); }
  20% { opacity: 1; }
  100% { opacity: 0; transform: translateY(-16px); }
}

.wnl-breathe {
  animation: wnlBreathe 3.6s ease-in-out infinite;
}

.wnl-wave {
  animation: wnlWave 4.4s linear infinite;
}

.wnl-pulse-soft {
  animation: wnlPulseSoft 1.6s ease-in-out infinite;
}

.wnl-float-up {
  animation: wnlFloatUp 1.2s ease-out forwards;
}

/* =========================
   RNest Night Mode (auto)
   Trigger: night_streak >= 3
   ========================= */

html.wnl-night {
  color-scheme: dark;
  --wnl-bg: #0B1220;
  --wnl-text: rgba(255,255,255,0.92);
  --wnl-sub: rgba(255,255,255,0.64);
  --wnl-muted: rgba(255,255,255,0.52);
  --wnl-card: #111A2E;
  --wnl-sep: rgba(255,255,255,0.12);
  --wnl-accent: #6CDAC3;
  --wnl-selection: rgba(108,218,195,0.22);
}

html.wnl-night body {
  background-color: var(--wnl-bg);
  color: var(--wnl-text);
}

html.wnl-night *::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.18);
}

/* Tailwind token overrides (best-effort) */
html.wnl-night .bg-ios-bg { background-color: #0B1220 !important; }
html.wnl-night .bg-ios-card { background-color: #111A2E !important; }
html.wnl-night .border-ios-sep { border-color: rgba(255,255,255,0.12) !important; }
html.wnl-night .text-ios-text { color: rgba(255,255,255,0.92) !important; }
html.wnl-night .text-ios-sub { color: rgba(255,255,255,0.62) !important; }
html.wnl-night .text-ios-muted { color: rgba(255,255,255,0.55) !important; }

/* Common utility colors used across the app */
html.wnl-night .bg-white { background-color: #111A2E !important; }
html.wnl-night .bg-white\/90 { background-color: rgba(17,26,46,0.90) !important; }
html.wnl-night .bg-white\/85 { background-color: rgba(17,26,46,0.85) !important; }
html.wnl-night .bg-white\/80 { background-color: rgba(17,26,46,0.80) !important; }
html.wnl-night .bg-white\/70 { background-color: rgba(17,26,46,0.70) !important; }
html.wnl-night .bg-white\/60 { background-color: rgba(17,26,46,0.60) !important; }
html.wnl-night .bg-white\/50 { background-color: rgba(17,26,46,0.50) !important; }

html.wnl-night .text-black { color: rgba(255,255,255,0.92) !important; }
html.wnl-night .text-black\/80 { color: rgba(255,255,255,0.80) !important; }
html.wnl-night .text-black\/70 { color: rgba(255,255,255,0.70) !important; }
html.wnl-night .text-black\/60 { color: rgba(255,255,255,0.60) !important; }
html.wnl-night .text-black\/50 { color: rgba(255,255,255,0.50) !important; }

html.wnl-night .bg-black\/5 { background-color: rgba(255,255,255,0.08) !important; }
html.wnl-night .bg-black\/7 { background-color: rgba(255,255,255,0.10) !important; }
html.wnl-night .bg-black\/10 { background-color: rgba(255,255,255,0.12) !important; }

html.wnl-night .focus\:ring-black\/10:focus { --tw-ring-color: rgba(255,255,255,0.18) !important; }

/* BottomNav in night mode */
html.wnl-night .wnl-nav-bar {
  background: #111A2E;
  border-color: rgba(255, 255, 255, 0.12);
  box-shadow: 0 14px 28px rgba(0, 0, 0, 0.35);
}

html.wnl-night .wnl-nav-active {
  background: rgba(255, 255, 255, 0.08);
  color: #6CDAC3;
}

html.wnl-night .wnl-nav-inactive {
  color: rgba(255, 255, 255, 0.6);
}
